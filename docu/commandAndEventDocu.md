# Poinz Command and Event Docu
This is an autogenerated docu. 12/18/2024, 7:38:05 PM  (Poinz version 0.20.4)

* Jump to [commands](#commands)
* Jump to [events](#events)

## Commands

 * [addStory](#command-addstory)
 * [changeStory](#command-changestory)
 * [clearStoryEstimate](#command-clearstoryestimate)
 * [deleteStory](#command-deletestory)
 * [giveStoryEstimate](#command-givestoryestimate)
 * [importStories](#command-importstories)
 * [joinRoom](#command-joinroom)
 * [kick](#command-kick)
 * [leaveRoom](#command-leaveroom)
 * [newEstimationRound](#command-newestimationround)
 * [restoreStory](#command-restorestory)
 * [reveal](#command-reveal)
 * [selectStory](#command-selectstory)
 * [setAvatar](#command-setavatar)
 * [setCardConfig](#command-setcardconfig)
 * [setEmail](#command-setemail)
 * [setPassword](#command-setpassword)
 * [setRoomConfig](#command-setroomconfig)
 * [setSortOrder](#command-setsortorder)
 * [setStoryValue](#command-setstoryvalue)
 * [setUsername](#command-setusername)
 * [settleEstimation](#command-settleestimation)
 * [toggleExclude](#command-toggleexclude)
 * [trashStory](#command-trashstory)


### Command "addStory"

Source: [/server/src/commandHandlers/addStory.js](/server/src/commandHandlers/addStory.js)

Description

```text
A user adds a story to the estimation backlog of the room
```

Produces: **[storyAdded](#event-storyAdded)**, **[storySelected](#event-storySelected)**, 


<details>
<summary>Schema</summary>
<p>

```json
{
    "allOf": [
        {
            "$ref": "command"
        },
        {
            "properties": {
                "payload": {
                    "type": "object",
                    "properties": {
                        "title": {
                            "type": "string",
                            "minLength": 1,
                            "maxLength": 100
                        },
                        "description": {
                            "type": "string",
                            "minLength": 0,
                            "maxLength": 2000
                        }
                    },
                    "required": [
                        "title"
                    ],
                    "additionalProperties": false
                }
            }
        }
    ]
}
```

</p>
</details>



### Command "changeStory"

Source: [/server/src/commandHandlers/changeStory.js](/server/src/commandHandlers/changeStory.js)

Description

```text
A user changes the title and/or description of a story
```

Produces: **[storyChanged](#event-storyChanged)**, 


<details>
<summary>Schema</summary>
<p>

```json
{
    "allOf": [
        {
            "$ref": "command"
        },
        {
            "properties": {
                "payload": {
                    "type": "object",
                    "properties": {
                        "storyId": {
                            "type": "string",
                            "format": "uuid"
                        },
                        "title": {
                            "type": "string",
                            "minLength": 1,
                            "maxLength": 100
                        },
                        "description": {
                            "type": "string",
                            "minLength": 0,
                            "maxLength": 2000
                        }
                    },
                    "required": [
                        "title",
                        "description",
                        "storyId"
                    ],
                    "additionalProperties": false
                }
            }
        }
    ]
}
```

</p>
</details>



### Command "clearStoryEstimate"

Source: [/server/src/commandHandlers/clearStoryEstimate.js](/server/src/commandHandlers/clearStoryEstimate.js)

Description

```text
A user clears his estimation value for a certain story.
Users may only clear estimation for the currently selected story.
```

Produces: **[storyEstimateCleared](#event-storyEstimateCleared)**, 


<details>
<summary>Schema</summary>
<p>

```json
{
    "allOf": [
        {
            "$ref": "command"
        },
        {
            "properties": {
                "payload": {
                    "type": "object",
                    "properties": {
                        "storyId": {
                            "type": "string",
                            "format": "uuid"
                        }
                    },
                    "required": [
                        "storyId"
                    ],
                    "additionalProperties": false
                }
            }
        }
    ]
}
```

</p>
</details>



### Command "deleteStory"

Source: [/server/src/commandHandlers/deleteStory.js](/server/src/commandHandlers/deleteStory.js)

Description

```text
A user deletes a story.
A story must be first marked as "trashed", before it can be deleted.
Story will be completely removed from room.
```

Produces: **[storyDeleted](#event-storyDeleted)**, 


<details>
<summary>Schema</summary>
<p>

```json
{
    "allOf": [
        {
            "$ref": "command"
        },
        {
            "properties": {
                "payload": {
                    "type": "object",
                    "properties": {
                        "storyId": {
                            "type": "string",
                            "format": "uuid"
                        }
                    },
                    "required": [
                        "storyId"
                    ],
                    "additionalProperties": false
                }
            }
        }
    ]
}
```

</p>
</details>



### Command "giveStoryEstimate"

Source: [/server/src/commandHandlers/giveStoryEstimate.js](/server/src/commandHandlers/giveStoryEstimate.js)

Description

```text
A user gives his estimation for a certain story.
Users may only give estimations for the currently selected story.
Users can optionally specify "confidence". if the value is above zero -> I'm confident.  if the value is below zero -> I'm unsure!.  If property is not provided, or 0 -> default.
A user that is marked as excluded (see toggleExclude/excludedFromEstimations)  cannot give estimations
As soon as all users (that can estimate) estimated the story, a "revealed" event is produced (by default, if room setting is not altered. see "autoReveal")
```

Produces: **[consensusAchieved](#event-consensusAchieved)**, **[revealed](#event-revealed)**, **[storyEstimateGiven](#event-storyEstimateGiven)**, 


<details>
<summary>Schema</summary>
<p>

```json
{
    "allOf": [
        {
            "$ref": "command"
        },
        {
            "properties": {
                "payload": {
                    "type": "object",
                    "properties": {
                        "storyId": {
                            "type": "string",
                            "format": "uuid"
                        },
                        "value": {
                            "type": "number"
                        },
                        "confidence": {
                            "type": "number"
                        }
                    },
                    "required": [
                        "storyId",
                        "value"
                    ],
                    "additionalProperties": false
                }
            }
        }
    ]
}
```

</p>
</details>



### Command "importStories"

Source: [/server/src/commandHandlers/importStories.js](/server/src/commandHandlers/importStories.js)

Description

```text
A user wants to import multiple stories.
payload.data is expected to be a base64 encoded "data url" (something like   data:text/csv;base64,U3VtbWFyeSxJc3N1ZSBrZXksSXNzdW.......   )
Will trigger "storyAdded" events for all successfully parsed stories
Will trigger "storySelected" event, if no story is selected
```

Produces: **[consensusAchieved](#event-consensusAchieved)**, **[importFailed](#event-importFailed)**, **[storyAdded](#event-storyAdded)**, **[storySelected](#event-storySelected)**, **[storyTrashed](#event-storyTrashed)**, 


<details>
<summary>Schema</summary>
<p>

```json
{
    "allOf": [
        {
            "$ref": "command"
        },
        {
            "properties": {
                "payload": {
                    "type": "object",
                    "properties": {
                        "data": {
                            "type": "string",
                            "format": "csvOrJsonDataUrl"
                        }
                    },
                    "required": [
                        "data"
                    ],
                    "additionalProperties": false
                }
            }
        }
    ]
}
```

</p>
</details>



### Command "joinRoom"

Source: [/server/src/commandHandlers/joinRoom.js](/server/src/commandHandlers/joinRoom.js)

Description

```text
A user joins a room.
Two scenarios:  either the room exists already or the room with the given id does not exist yet.
If the room does not yet exist, an additional "roomCreated" event is produced (as the first event).
Produces also a "roomJoined" event (which contains the room state).
Produces also events for additional properties if they are preset "usernameSet", "emailSet", "excludedFromEstimations".
For password protected rooms, we will create a Json Web Token (JWT) with an expiration date of 1 hour and pass it to the one joining user via "tokenIssued" event.
```

Produces: **[avatarSet](#event-avatarSet)**, **[emailSet](#event-emailSet)**, **[excludedFromEstimations](#event-excludedFromEstimations)**, **[joinedRoom](#event-joinedRoom)**, **[roomCreated (restricted)](#event-roomCreated)**, **[storyAdded](#event-storyAdded)**, **[storySelected](#event-storySelected)**, **[tokenIssued (restricted)](#event-tokenIssued)**, **[usernameSet](#event-usernameSet)**, 


<details>
<summary>Schema</summary>
<p>

```json
{
    "allOf": [
        {
            "$ref": "command"
        },
        {
            "properties": {
                "payload": {
                    "type": "object",
                    "properties": {
                        "username": {
                            "type": "string",
                            "format": "username"
                        },
                        "email": {
                            "type": "string",
                            "format": "email"
                        },
                        "avatar": {
                            "type": "number"
                        },
                        "password": {
                            "type": "string",
                            "minLength": 0
                        },
                        "token": {
                            "type": "string"
                        }
                    },
                    "required": [
                        "username"
                    ],
                    "additionalProperties": false
                }
            }
        }
    ]
}
```

</p>
</details>



### Command "kick"

Source: [/server/src/commandHandlers/kick.js](/server/src/commandHandlers/kick.js)

Description

```text
A user removes a disconnected user from the room.
```

Produces: **[kicked](#event-kicked)**, 


<details>
<summary>Schema</summary>
<p>

```json
{
    "allOf": [
        {
            "$ref": "command"
        },
        {
            "properties": {
                "payload": {
                    "type": "object",
                    "properties": {
                        "userId": {
                            "type": "string",
                            "format": "uuid"
                        }
                    },
                    "required": [
                        "userId"
                    ],
                    "additionalProperties": false
                }
            }
        }
    ]
}
```

</p>
</details>



### Command "leaveRoom"

Source: [/server/src/commandHandlers/leaveRoom.js](/server/src/commandHandlers/leaveRoom.js)

Description

```text
A user wants to leave the room.
Is also produced by the socketServer itself on connection lost!
```

Produces: **[connectionLost](#event-connectionLost)**, **[leftRoom](#event-leftRoom)**, 


<details>
<summary>Schema</summary>
<p>

```json
{
    "allOf": [
        {
            "$ref": "command"
        },
        {
            "properties": {
                "payload": {
                    "type": "object",
                    "properties": {
                        "connectionLost": {
                            "type": "boolean"
                        }
                    },
                    "required": [],
                    "additionalProperties": false
                }
            }
        }
    ]
}
```

</p>
</details>



### Command "newEstimationRound"

Source: [/server/src/commandHandlers/newEstimationRound.js](/server/src/commandHandlers/newEstimationRound.js)

Description

```text
A user starts a new estimation round for a certain story.
This will clear all estimations given by users for this story.
This will reset any consensus that might have been achieved previously.
Can only be done for the currently selected story.
```

Produces: **[newEstimationRoundStarted](#event-newEstimationRoundStarted)**, 


<details>
<summary>Schema</summary>
<p>

```json
{
    "allOf": [
        {
            "$ref": "command"
        },
        {
            "properties": {
                "payload": {
                    "type": "object",
                    "properties": {
                        "storyId": {
                            "type": "string",
                            "format": "uuid"
                        }
                    },
                    "required": [
                        "storyId"
                    ],
                    "additionalProperties": false
                }
            }
        }
    ]
}
```

</p>
</details>



### Command "restoreStory"

Source: [/server/src/commandHandlers/restoreStory.js](/server/src/commandHandlers/restoreStory.js)

Description

```text
A user restores a story.
A story must be first marked as "trashed", before it can be restored.
Story will no longer be marked as "trashed".
```

Produces: **[storyRestored](#event-storyRestored)**, **[storySelected](#event-storySelected)**, 


<details>
<summary>Schema</summary>
<p>

```json
{
    "allOf": [
        {
            "$ref": "command"
        },
        {
            "properties": {
                "payload": {
                    "type": "object",
                    "properties": {
                        "storyId": {
                            "type": "string",
                            "format": "uuid"
                        }
                    },
                    "required": [
                        "storyId"
                    ],
                    "additionalProperties": false
                }
            }
        }
    ]
}
```

</p>
</details>



### Command "reveal"

Source: [/server/src/commandHandlers/reveal.js](/server/src/commandHandlers/reveal.js)

Description

```text
A user manually reveals estimates for a certain story
Users may only reveal the currently selected story
If story is already revealed, reject command.
```

Produces: **[consensusAchieved](#event-consensusAchieved)**, **[revealed](#event-revealed)**, 


<details>
<summary>Schema</summary>
<p>

```json
{
    "allOf": [
        {
            "$ref": "command"
        },
        {
            "properties": {
                "payload": {
                    "type": "object",
                    "properties": {
                        "storyId": {
                            "type": "string",
                            "format": "uuid"
                        }
                    },
                    "required": [
                        "storyId"
                    ],
                    "additionalProperties": false
                }
            }
        }
    ]
}
```

</p>
</details>



### Command "selectStory"

Source: [/server/src/commandHandlers/selectStory.js](/server/src/commandHandlers/selectStory.js)

Description

```text
A user selected a story (marked it as the "current" story to estimate)
```

Produces: **[storySelected](#event-storySelected)**, 


<details>
<summary>Schema</summary>
<p>

```json
{
    "allOf": [
        {
            "$ref": "command"
        },
        {
            "properties": {
                "payload": {
                    "type": "object",
                    "properties": {
                        "storyId": {
                            "type": "string",
                            "format": "uuid"
                        }
                    },
                    "required": [
                        "storyId"
                    ],
                    "additionalProperties": false
                }
            }
        }
    ]
}
```

</p>
</details>



### Command "setAvatar"

Source: [/server/src/commandHandlers/setAvatar.js](/server/src/commandHandlers/setAvatar.js)

Description

```text
A user sets his avatar. Identified with a number, starting with 0.
Only the client (App) knows which and how many avatars exist and also which number maps to which avatar.
Currently, 0 is the "anonymous" avatar and used by default.
```

Produces: **[avatarSet](#event-avatarSet)**, 


<details>
<summary>Schema</summary>
<p>

```json
{
    "allOf": [
        {
            "$ref": "command"
        },
        {
            "properties": {
                "payload": {
                    "type": "object",
                    "properties": {
                        "avatar": {
                            "type": "number"
                        }
                    },
                    "required": [
                        "avatar"
                    ],
                    "additionalProperties": false
                }
            }
        }
    ]
}
```

</p>
</details>



### Command "setCardConfig"

Source: [/server/src/commandHandlers/setCardConfig.js](/server/src/commandHandlers/setCardConfig.js)

Description

```text
A user sets a custom card configuration on the room.
```

Produces: **[cardConfigSet](#event-cardConfigSet)**, 


<details>
<summary>Schema</summary>
<p>

```json
{
    "allOf": [
        {
            "$ref": "command"
        },
        {
            "properties": {
                "payload": {
                    "type": "object",
                    "properties": {
                        "cardConfig": {
                            "type": "array",
                            "minItems": 0,
                            "items": {
                                "type": "object",
                                "properties": {
                                    "value": {
                                        "type": [
                                            "number",
                                            "string"
                                        ],
                                        "format": "parseableNumber"
                                    },
                                    "label": {
                                        "type": "string"
                                    },
                                    "color": {
                                        "type": "string"
                                    }
                                },
                                "required": [
                                    "value",
                                    "label",
                                    "color"
                                ],
                                "additionalProperties": false
                            },
                            "format": "cardConfig"
                        }
                    },
                    "required": [
                        "cardConfig"
                    ],
                    "additionalProperties": false
                }
            }
        }
    ]
}
```

</p>
</details>



### Command "setEmail"

Source: [/server/src/commandHandlers/setEmail.js](/server/src/commandHandlers/setEmail.js)

Description

```text
A user sets his email address (used for Gravatar image fetching. See https://en.gravatar.com/ ).
```

Produces: **[emailSet](#event-emailSet)**, 


<details>
<summary>Schema</summary>
<p>

```json
{
    "allOf": [
        {
            "$ref": "command"
        },
        {
            "properties": {
                "payload": {
                    "type": "object",
                    "properties": {
                        "email": {
                            "type": "string",
                            "format": "email"
                        }
                    },
                    "comment": "do not set email as required. if not set or empty string (or falsy value) will reset email",
                    "required": [],
                    "additionalProperties": false
                }
            }
        }
    ]
}
```

</p>
</details>



### Command "setPassword"

Source: [/server/src/commandHandlers/setPassword.js](/server/src/commandHandlers/setPassword.js)

Description

```text
A user sets (or re-sets) a password for this room. If the password is undefined or empty, the password protection is removed (passwordCleared event).
Currently this can be done without specifying the old password.
Note: All currently valid JWT will still be valid even after password is edited. currently expiration time for our tokens is 60 minutes.
```

Produces: **[passwordCleared](#event-passwordCleared)**, **[passwordSet](#event-passwordSet)**, 


<details>
<summary>Schema</summary>
<p>

```json
{
    "allOf": [
        {
            "$ref": "command"
        },
        {
            "properties": {
                "payload": {
                    "type": "object",
                    "properties": {
                        "password": {
                            "type": "string",
                            "minLength": 0
                        }
                    },
                    "comment": "do not set password as required. if not set or empty string (or falsy value) will reset pw -> remove pw protection from room",
                    "required": [],
                    "additionalProperties": false
                }
            }
        }
    ]
}
```

</p>
</details>



### Command "setRoomConfig"

Source: [/server/src/commandHandlers/setRoomConfig.js](/server/src/commandHandlers/setRoomConfig.js)

Description

```text
This command allows to set multiple config properties on the room:
# Issue Tracking URL
If such a URL is set, imported stories will have a link to the issue e.g. on jira.
The placeholder {ISSUE} in the url will be replaced with the respective issue key.
Example for such a issue tracking URL:  https://jira.mycompany.com/browse/{ISSUE}
# AutoReveal
This is by default "on". Room wil automatically reveal current story if all users estimated.
# WithConfidence
This is by default "off". If enabled, users can specify their estimation "confidence"
```

Produces: **[roomConfigSet](#event-roomConfigSet)**, 


<details>
<summary>Schema</summary>
<p>

```json
{
    "allOf": [
        {
            "$ref": "command"
        },
        {
            "properties": {
                "payload": {
                    "type": "object",
                    "properties": {
                        "autoReveal": [
                            "boolean",
                            "undefined",
                            "null"
                        ],
                        "withConfidence": [
                            "boolean",
                            "undefined",
                            "null"
                        ],
                        "issueTrackingUrl": [
                            "string",
                            "undefined",
                            "null"
                        ]
                    },
                    "required": [],
                    "additionalProperties": false
                }
            }
        }
    ]
}
```

</p>
</details>



### Command "setSortOrder"

Source: [/server/src/commandHandlers/setSortOrder.js](/server/src/commandHandlers/setSortOrder.js)

Description

```text
A user re-orders the backlog manually.
This command will set the new sortOrder of all active stories in the room.
Trashed stories will not be affected. (sortOrder = undefined).
```

Produces: **[sortOrderSet](#event-sortOrderSet)**, 


<details>
<summary>Schema</summary>
<p>

```json
{
    "allOf": [
        {
            "$ref": "command"
        },
        {
            "properties": {
                "payload": {
                    "type": "object",
                    "properties": {
                        "sortOrder": {
                            "type": "array",
                            "items": {
                                "type": "string",
                                "format": "uuid"
                            }
                        }
                    },
                    "required": [
                        "sortOrder"
                    ],
                    "additionalProperties": false
                }
            }
        }
    ]
}
```

</p>
</details>



### Command "setStoryValue"

Source: [/server/src/commandHandlers/setStoryValue.js](/server/src/commandHandlers/setStoryValue.js)

Description

```text
A user manually sets the value for a story.
This command is used in the story estimation matrix and can be used for all stories, at any given time.
```

Produces: **[storyValueSet](#event-storyValueSet)**, 


<details>
<summary>Schema</summary>
<p>

```json
{
    "allOf": [
        {
            "$ref": "command"
        },
        {
            "properties": {
                "payload": {
                    "type": "object",
                    "properties": {
                        "storyId": {
                            "type": "string",
                            "format": "uuid"
                        },
                        "value": {
                            "type": "number"
                        }
                    },
                    "required": [
                        "storyId",
                        "value"
                    ],
                    "additionalProperties": false
                }
            }
        }
    ]
}
```

</p>
</details>



### Command "setUsername"

Source: [/server/src/commandHandlers/setUsername.js](/server/src/commandHandlers/setUsername.js)

Description

```text
A user sets his username.
```

Produces: **[usernameSet](#event-usernameSet)**, 


<details>
<summary>Schema</summary>
<p>

```json
{
    "allOf": [
        {
            "$ref": "command"
        },
        {
            "properties": {
                "payload": {
                    "type": "object",
                    "properties": {
                        "username": {
                            "type": "string",
                            "format": "username"
                        }
                    },
                    "required": [
                        "username"
                    ],
                    "additionalProperties": false
                }
            }
        }
    ]
}
```

</p>
</details>



### Command "settleEstimation"

Source: [/server/src/commandHandlers/settleEstimation.js](/server/src/commandHandlers/settleEstimation.js)

Description

```text
A user manually "settles" on a value for a story. (hopefully after a discussion with everybody in the room).
This will produce "consensusAchieved".
This saves the team the time to start a new round where everybody has to estimate the same value.
Compared to the "setStoryValue" command (introduced in #364), which can be used for all stories, at any given time, this can only be used for the currently selected story. After it was revealed.
```

Produces: **[consensusAchieved](#event-consensusAchieved)**, 


<details>
<summary>Schema</summary>
<p>

```json
{
    "allOf": [
        {
            "$ref": "command"
        },
        {
            "properties": {
                "payload": {
                    "type": "object",
                    "properties": {
                        "storyId": {
                            "type": "string",
                            "format": "uuid"
                        },
                        "value": {
                            "type": "number"
                        }
                    },
                    "required": [
                        "storyId",
                        "value"
                    ],
                    "additionalProperties": false
                }
            }
        }
    ]
}
```

</p>
</details>



### Command "toggleExclude"

Source: [/server/src/commandHandlers/toggleExclude.js](/server/src/commandHandlers/toggleExclude.js)

Description

```text
Marks a user as "Spectator" (excluded from estimations)
If user is marked as excluded, he cannot estimate stories.
As of #200, every user can "exclude" every other user -> we pass the userId in the payload of the command
```

Produces: **[excludedFromEstimations](#event-excludedFromEstimations)**, **[includedInEstimations](#event-includedInEstimations)**, 


<details>
<summary>Schema</summary>
<p>

```json
{
    "allOf": [
        {
            "$ref": "command"
        },
        {
            "properties": {
                "payload": {
                    "type": "object",
                    "properties": {
                        "userId": {
                            "type": "string",
                            "format": "uuid"
                        }
                    },
                    "required": [
                        "userId"
                    ],
                    "additionalProperties": false
                }
            }
        }
    ]
}
```

</p>
</details>



### Command "trashStory"

Source: [/server/src/commandHandlers/trashStory.js](/server/src/commandHandlers/trashStory.js)

Description

```text
A user "trashes" a story  (marked as trashed, still in room).
If the story that is "trashed" is the selectedStory in the room, an additional "storySelected" event is produced
```

Produces: **[storySelected](#event-storySelected)**, **[storyTrashed](#event-storyTrashed)**, 


<details>
<summary>Schema</summary>
<p>

```json
{
    "allOf": [
        {
            "$ref": "command"
        },
        {
            "properties": {
                "payload": {
                    "type": "object",
                    "properties": {
                        "storyId": {
                            "type": "string",
                            "format": "uuid"
                        }
                    },
                    "required": [
                        "storyId"
                    ],
                    "additionalProperties": false
                }
            }
        }
    ]
}
```

</p>
</details>




## Events

 * [storyAdded](#event-storyadded)
 * [storySelected](#event-storyselected)
 * [storyChanged](#event-storychanged)
 * [storyEstimateCleared](#event-storyestimatecleared)
 * [storyDeleted](#event-storydeleted)
 * [consensusAchieved](#event-consensusachieved)
 * [revealed](#event-revealed)
 * [storyEstimateGiven](#event-storyestimategiven)
 * [importFailed](#event-importfailed)
 * [storyTrashed](#event-storytrashed)
 * [avatarSet](#event-avatarset)
 * [emailSet](#event-emailset)
 * [excludedFromEstimations](#event-excludedfromestimations)
 * [joinedRoom](#event-joinedroom)
 * [roomCreated](#event-roomcreated)
 * [tokenIssued](#event-tokenissued)
 * [usernameSet](#event-usernameset)
 * [kicked](#event-kicked)
 * [connectionLost](#event-connectionlost)
 * [leftRoom](#event-leftroom)
 * [newEstimationRoundStarted](#event-newestimationroundstarted)
 * [storyRestored](#event-storyrestored)
 * [cardConfigSet](#event-cardconfigset)
 * [passwordCleared](#event-passwordcleared)
 * [passwordSet](#event-passwordset)
 * [roomConfigSet](#event-roomconfigset)
 * [sortOrderSet](#event-sortorderset)
 * [storyValueSet](#event-storyvalueset)
 * [includedInEstimations](#event-includedinestimations)


### Event "storyAdded"

Source: [/server/src/eventHandlers/storyAdded.js](/server/src/eventHandlers/storyAdded.js)

Produced by: **[addStory](#command-addStory)** **[importStories](#command-importStories)** **[joinRoom](#command-joinRoom)** 



Description

```text
a new story was added to the room
```


### Event "storySelected"

Source: [/server/src/eventHandlers/storySelected.js](/server/src/eventHandlers/storySelected.js)

Produced by: **[addStory](#command-addStory)** **[importStories](#command-importStories)** **[joinRoom](#command-joinRoom)** **[restoreStory](#command-restoreStory)** **[selectStory](#command-selectStory)** **[trashStory](#command-trashStory)** 



Description

```text
Store id of given story as "selectedStory"
```


### Event "storyChanged"

Source: [/server/src/eventHandlers/storyChanged.js](/server/src/eventHandlers/storyChanged.js)

Produced by: **[changeStory](#command-changeStory)** 



Description

```text
Title and/or Description of story changed
```


### Event "storyEstimateCleared"

Source: [/server/src/eventHandlers/storyEstimateCleared.js](/server/src/eventHandlers/storyEstimateCleared.js)

Produced by: **[clearStoryEstimate](#command-clearStoryEstimate)** 



Description

```text
Removes a previously set estimation value on the given story for the given user
```


### Event "storyDeleted"

Source: [/server/src/eventHandlers/storyDeleted.js](/server/src/eventHandlers/storyDeleted.js)

Produced by: **[deleteStory](#command-deleteStory)** 



Description

```text
Removes matching story from "stories" list in room
```


### Event "consensusAchieved"

Source: [/server/src/eventHandlers/consensusAchieved.js](/server/src/eventHandlers/consensusAchieved.js)

Produced by: **[giveStoryEstimate](#command-giveStoryEstimate)** **[importStories](#command-importStories)** **[reveal](#command-reveal)** **[settleEstimation](#command-settleEstimation)** 



Description

```text
Stores consensus estimation value (that everybody agreed on) on story.
```


### Event "revealed"

Source: [/server/src/eventHandlers/revealed.js](/server/src/eventHandlers/revealed.js)

Produced by: **[giveStoryEstimate](#command-giveStoryEstimate)** **[reveal](#command-reveal)** 



Description

```text
Estimations for the given story were revealed.
This happens automatically if all users that can estimate (not marked as excluded, not disconnected) did estimate the current story (i.e. if the last user gives his estimate)
This happens if a user manually reveals. (this is helpful, if someone is AFK and team wants to proceed with the estimation meeting)
```


### Event "storyEstimateGiven"

Source: [/server/src/eventHandlers/storyEstimateGiven.js](/server/src/eventHandlers/storyEstimateGiven.js)

Produced by: **[giveStoryEstimate](#command-giveStoryEstimate)** 



Description

```text
Stores the given estimation value on the story for the given user
```


### Event "importFailed"

Source: [/server/src/eventHandlers/importFailed.js](/server/src/eventHandlers/importFailed.js)

Produced by: **[importStories](#command-importStories)** 



Description

```text
a stories import (csv) failed. Does not modify room in any way,
```


### Event "storyTrashed"

Source: [/server/src/eventHandlers/storyTrashed.js](/server/src/eventHandlers/storyTrashed.js)

Produced by: **[importStories](#command-importStories)** **[trashStory](#command-trashStory)** 



Description

```text
Marks matching story as "trashed".  Story stays in room.
```


### Event "avatarSet"

Source: [/server/src/eventHandlers/avatarSet.js](/server/src/eventHandlers/avatarSet.js)

Produced by: **[joinRoom](#command-joinRoom)** **[setAvatar](#command-setAvatar)** 



Description

```text
user sets his avatar (number)
```


### Event "emailSet"

Source: [/server/src/eventHandlers/emailSet.js](/server/src/eventHandlers/emailSet.js)

Produced by: **[joinRoom](#command-joinRoom)** **[setEmail](#command-setEmail)** 



Description

```text
user set his email address
```


### Event "excludedFromEstimations"

Source: [/server/src/eventHandlers/excludedFromEstimations.js](/server/src/eventHandlers/excludedFromEstimations.js)

Produced by: **[joinRoom](#command-joinRoom)** **[toggleExclude](#command-toggleExclude)** 



Description

```text
Sets "excluded" flag on user to true.
(user is now a "spectator")
```


### Event "joinedRoom"

Source: [/server/src/eventHandlers/joinedRoom.js](/server/src/eventHandlers/joinedRoom.js)

Produced by: **[joinRoom](#command-joinRoom)** 



Description

```text
A user joined a room: update "users" array in room object.
"users" array is already correctly built in handler of joinRoom command (../commandHandlers/joinRoom.js)
```


### Event "roomCreated"

Source: [/server/src/eventHandlers/roomCreated.js](/server/src/eventHandlers/roomCreated.js)

Produced by: **[joinRoom](#command-joinRoom)** 

NOTE: This event is marked as **restricted** and is thus only sent to the one client that triggered it.

Description

```text
A room was created. Creates a new default room object
```


### Event "tokenIssued"

Source: [/server/src/eventHandlers/tokenIssued.js](/server/src/eventHandlers/tokenIssued.js)

Produced by: **[joinRoom](#command-joinRoom)** 

NOTE: This event is marked as **restricted** and is thus only sent to the one client that triggered it.

Description

```text
The server issued a new JWT token. this does not modify the room in any way.
```


### Event "usernameSet"

Source: [/server/src/eventHandlers/usernameSet.js](/server/src/eventHandlers/usernameSet.js)

Produced by: **[joinRoom](#command-joinRoom)** **[setUsername](#command-setUsername)** 



Description

```text
user set his name
```


### Event "kicked"

Source: [/server/src/eventHandlers/kicked.js](/server/src/eventHandlers/kicked.js)

Produced by: **[kick](#command-kick)** 



Description

```text
removes user from "users" list
removes estimations on all stories that were given by user
```


### Event "connectionLost"

Source: [/server/src/eventHandlers/connectionLost.js](/server/src/eventHandlers/connectionLost.js)

Produced by: **[leaveRoom](#command-leaveRoom)** 



Description

```text
Marks user as "disconnected".
```


### Event "leftRoom"

Source: [/server/src/eventHandlers/leftRoom.js](/server/src/eventHandlers/leftRoom.js)

Produced by: **[leaveRoom](#command-leaveRoom)** 



Description

```text
removes user from "users" list
removes estimations on all stories that were given by user
```


### Event "newEstimationRoundStarted"

Source: [/server/src/eventHandlers/newEstimationRoundStarted.js](/server/src/eventHandlers/newEstimationRoundStarted.js)

Produced by: **[newEstimationRound](#command-newEstimationRound)** 



Description

```text
Clears all estimations on story, sets "revealed" flag to false and erases "consensus"
```


### Event "storyRestored"

Source: [/server/src/eventHandlers/storyRestored.js](/server/src/eventHandlers/storyRestored.js)

Produced by: **[restoreStory](#command-restoreStory)** 



Description

```text
Resets "trashed" flag on matching story.
Flag will be "false" afterwards.
```


### Event "cardConfigSet"

Source: [/server/src/eventHandlers/cardConfigSet.js](/server/src/eventHandlers/cardConfigSet.js)

Produced by: **[setCardConfig](#command-setCardConfig)** 



Description

```text
user did set custom cardConfig on room
```


### Event "passwordCleared"

Source: [/server/src/eventHandlers/passwordCleared.js](/server/src/eventHandlers/passwordCleared.js)

Produced by: **[setPassword](#command-setPassword)** 



Description

```text
user removed password protection from room
```


### Event "passwordSet"

Source: [/server/src/eventHandlers/passwordSet.js](/server/src/eventHandlers/passwordSet.js)

Produced by: **[setPassword](#command-setPassword)** 



Description

```text
user did set new password for room
```


### Event "roomConfigSet"

Source: [/server/src/eventHandlers/roomConfigSet.js](/server/src/eventHandlers/roomConfigSet.js)

Produced by: **[setRoomConfig](#command-setRoomConfig)** 



Description

```text
sets autoReveal, withConfidence flags on room.
sets issueTrackingUrl on room
```


### Event "sortOrderSet"

Source: [/server/src/eventHandlers/sortOrderSet.js](/server/src/eventHandlers/sortOrderSet.js)

Produced by: **[setSortOrder](#command-setSortOrder)** 



Description

```text
A user did re-order the backlog manually.
This did set the new sortOrder on all active stories in the room.
Trashed stories will not be affected. (sortOrder = undefined).
```


### Event "storyValueSet"

Source: [/server/src/eventHandlers/storyValueSet.js](/server/src/eventHandlers/storyValueSet.js)

Produced by: **[setStoryValue](#command-setStoryValue)** 



Description

```text
Stores consensus estimation value on story.
Technically the same as "consensusAchieved" event, but this is used for the "setStoryValue" command. and has a different semantic.
```


### Event "includedInEstimations"

Source: [/server/src/eventHandlers/includedInEstimations.js](/server/src/eventHandlers/includedInEstimations.js)

Produced by: **[toggleExclude](#command-toggleExclude)** 



Description

```text
Sets "excluded" flag on user to false.
(user is no longer "spectator")
```



